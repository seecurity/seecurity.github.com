<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 14.1.1 (20251213.1925)
 -->
<!-- Title: Flow Pages: 1 -->
<svg width="1348pt" height="1170pt"
 viewBox="0.00 0.00 1348.00 1170.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 1165.72)">
<title>Flow</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-1165.72 1344.24,-1165.72 1344.24,4 -4,4"/>
<!-- RFC6311 -->
<g id="node1" class="node">
<title>RFC6311</title>
<g id="a_node1"><a xlink:title="The IPsec protocol suite is widely used for business&#45;critical network traffic. In order to make IPsec deployments highly available, more scalable, and failure&#45;resistant, they are often implemented as IPsec High Availability (HA) clusters. However, there are many issues in IPsec HA clustering, and in particular in Internet Key Exchange Protocol version 2 (IKEv2) clustering. An earlier document, IPsec Cluster Problem Statement, enumerates the issues encountered in the IKEv2/IPsec HA cluster environment. This document resolves these issues with the least possible change to the protocol. This document defines an extension to the IKEv2 protocol to solve the main issues of IPsec Cluster Problem Statement in the commonly deployed hot standby cluster, and provides implementation advice for other issues. The main issues solved are the synchronization of IKEv2 Message ID counters, and of IPsec replay counters. [STANDARDS&#45;TRACK]">
<ellipse fill="green" stroke="black" stroke-width="3" cx="471.75" cy="-783.81" rx="208.6" ry="65.05"/>
<text xml:space="preserve" text-anchor="middle" x="471.75" y="-808.71" font-family="Times,serif" font-size="18.00">RFC6311</text>
<text xml:space="preserve" text-anchor="middle" x="471.75" y="-787.71" font-family="Times,serif" font-size="18.00">Protocol Support for High Availability</text>
<text xml:space="preserve" text-anchor="middle" x="471.75" y="-766.71" font-family="Times,serif" font-size="18.00">of IKEv2/IPsec</text>
<text xml:space="preserve" text-anchor="middle" x="471.75" y="-745.71" font-family="Times,serif" font-size="18.00">2011</text>
</a>
</g>
</g>
<!-- obs -->
<g id="node3" class="node">
<title>obs</title>
<polygon fill="lightblue" stroke="black" points="864.79,-950.89 798.54,-950.89 798.54,-914.89 864.79,-914.89 864.79,-950.89"/>
<text xml:space="preserve" text-anchor="middle" x="831.66" y="-927.84" font-family="Times,serif" font-size="14.00">obsoletes</text>
</g>
<!-- RFC6311&#45;&gt;obs -->
<g id="edge2" class="edge">
<title>RFC6311&#45;&gt;obs</title>
<path fill="none" stroke="black" d="M599.15,-836.58C665,-863.86 741.14,-895.4 787.85,-914.74"/>
<polygon fill="black" stroke="black" points="786.23,-917.86 796.81,-918.46 788.91,-911.39 786.23,-917.86"/>
</g>
<!-- updates -->
<g id="node4" class="node">
<title>updates</title>
<polygon fill="lightyellow" stroke="black" points="649.46,-1161.72 592.21,-1161.72 592.21,-1125.72 649.46,-1125.72 649.46,-1161.72"/>
<text xml:space="preserve" text-anchor="middle" x="620.83" y="-1138.67" font-family="Times,serif" font-size="14.00">updates</text>
</g>
<!-- RFC6311&#45;&gt;updates -->
<g id="edge3" class="edge">
<title>RFC6311&#45;&gt;updates</title>
<path fill="none" stroke="black" d="M498.92,-849.41C531.68,-928.48 585.27,-1057.86 608.95,-1115.02"/>
<polygon fill="black" stroke="black" points="605.63,-1116.16 612.69,-1124.06 612.1,-1113.48 605.63,-1116.16"/>
</g>
<!-- cites -->
<g id="node6" class="node">
<title>cites</title>
<polygon fill="lightblue" stroke="black" points="349.67,-1161.72 295.67,-1161.72 295.67,-1125.72 349.67,-1125.72 349.67,-1161.72"/>
<text xml:space="preserve" text-anchor="middle" x="322.67" y="-1138.67" font-family="Times,serif" font-size="14.00">cites</text>
</g>
<!-- RFC6311&#45;&gt;cites -->
<g id="edge5" class="edge">
<title>RFC6311&#45;&gt;cites</title>
<path fill="none" stroke="black" d="M444.58,-849.41C411.83,-928.48 358.24,-1057.86 334.56,-1115.02"/>
<polygon fill="black" stroke="black" points="331.41,-1113.48 330.82,-1124.06 337.88,-1116.16 331.41,-1113.48"/>
</g>
<!-- obs_by -->
<g id="node2" class="node">
<title>obs_by</title>
<polygon fill="lightblue" stroke="black" points="144.97,-950.89 78.72,-950.89 78.72,-914.89 144.97,-914.89 144.97,-950.89"/>
<text xml:space="preserve" text-anchor="middle" x="111.84" y="-927.84" font-family="Times,serif" font-size="14.00">obsoletes</text>
</g>
<!-- obs_by&#45;&gt;RFC6311 -->
<g id="edge1" class="edge">
<title>obs_by&#45;&gt;RFC6311</title>
<path fill="none" stroke="black" d="M145.38,-919C188.29,-901.23 265.25,-869.35 333.67,-841.01"/>
<polygon fill="black" stroke="black" points="334.83,-844.32 342.73,-837.26 332.16,-837.85 334.83,-844.32"/>
</g>
<!-- updated_by -->
<g id="node5" class="node">
<title>updated_by</title>
<polygon fill="lightyellow" stroke="black" points="140.47,-652.73 83.22,-652.73 83.22,-616.73 140.47,-616.73 140.47,-652.73"/>
<text xml:space="preserve" text-anchor="middle" x="111.84" y="-629.68" font-family="Times,serif" font-size="14.00">updates</text>
</g>
<!-- updated_by&#45;&gt;RFC6311 -->
<g id="edge4" class="edge">
<title>updated_by&#45;&gt;RFC6311</title>
<path fill="none" stroke="black" d="M140.69,-646.68C182.5,-664 262.73,-697.23 333.73,-726.64"/>
<polygon fill="black" stroke="black" points="332.16,-729.78 342.74,-730.37 334.84,-723.31 332.16,-729.78"/>
</g>
<!-- rev_cites -->
<g id="node7" class="node">
<title>rev_cites</title>
<polygon fill="lightblue" stroke="black" points="647.83,-441.9 593.83,-441.9 593.83,-405.9 647.83,-405.9 647.83,-441.9"/>
<text xml:space="preserve" text-anchor="middle" x="620.83" y="-418.85" font-family="Times,serif" font-size="14.00">cites</text>
</g>
<!-- rev_cites&#45;&gt;RFC6311 -->
<g id="edge6" class="edge">
<title>rev_cites&#45;&gt;RFC6311</title>
<path fill="none" stroke="black" d="M613.24,-442.25C593.3,-490.38 538.6,-622.43 503.35,-707.53"/>
<polygon fill="black" stroke="black" points="500.22,-705.95 499.63,-716.53 506.69,-708.63 500.22,-705.95"/>
</g>
<!-- RFC7383 -->
<g id="node8" class="node">
<title>RFC7383</title>
<g id="a_node8"><a xlink:href="RFC7383.html" xlink:title="This document describes a way to avoid IP fragmentation of large Internet Key Exchange Protocol version 2 (IKEv2) messages. &#160;This allows IKEv2 messages to traverse network devices that do not allow IP fragments to pass through." target="_top">
<ellipse fill="none" stroke="black" cx="173.59" cy="-63.99" rx="173.59" ry="52.33"/>
<text xml:space="preserve" text-anchor="middle" x="173.59" y="-83.69" font-family="Times,serif" font-size="14.00">RFC7383</text>
<text xml:space="preserve" text-anchor="middle" x="173.59" y="-67.19" font-family="Times,serif" font-size="14.00">Internet Key Exchange Protocol Version 2</text>
<text xml:space="preserve" text-anchor="middle" x="173.59" y="-50.69" font-family="Times,serif" font-size="14.00">(IKEv2) Message Fragmentation</text>
<text xml:space="preserve" text-anchor="middle" x="173.59" y="-34.19" font-family="Times,serif" font-size="14.00">2014</text>
</a>
</g>
</g>
<!-- RFC7383&#45;&gt;rev_cites -->
<g id="edge7" class="edge">
<title>RFC7383&#45;&gt;rev_cites</title>
<path fill="none" stroke="black" d="M234.84,-113.28C331.43,-191.01 515.7,-339.3 589.31,-398.54"/>
<polygon fill="black" stroke="black" points="586.97,-401.14 596.95,-404.69 591.36,-395.69 586.97,-401.14"/>
</g>
<!-- RFC8750 -->
<g id="node9" class="node">
<title>RFC8750</title>
<g id="a_node9"><a xlink:href="RFC8750.html" xlink:title="Encapsulating Security Payload (ESP) sends an initialization vector (IV) in each packet. &#160;The size of the IV depends on the applied transform and is usually 8 or 16 octets for the transforms defined at the time this document was written. &#160;When used with IPsec, some algorithms, such as AES&#45;GCM, AES&#45;CCM, and ChaCha20&#45;Poly1305, take the IV to generate a nonce that is used as an input parameter for encrypting and decrypting. &#160;This IV must be unique but can be predictable. &#160;As a result, the value provided in the ESP Sequence Number (SN) can be used instead to generate the nonce. &#160;This avoids sending the IV itself and saves 8 octets per packet in the case of AES&#45;GCM, AES&#45;CCM, and ChaCha20&#45;Poly1305. &#160;This document describes how to do this." target="_top">
<ellipse fill="none" stroke="black" cx="769.91" cy="-63.99" rx="167.76" ry="63.99"/>
<text xml:space="preserve" text-anchor="middle" x="769.91" y="-91.94" font-family="Times,serif" font-size="14.00">RFC8750</text>
<text xml:space="preserve" text-anchor="middle" x="769.91" y="-75.44" font-family="Times,serif" font-size="14.00">Implicit Initialization Vector (IV) for</text>
<text xml:space="preserve" text-anchor="middle" x="769.91" y="-58.94" font-family="Times,serif" font-size="14.00">Counter&#45;Based Ciphers in Encapsulating</text>
<text xml:space="preserve" text-anchor="middle" x="769.91" y="-42.44" font-family="Times,serif" font-size="14.00">Security Payload (ESP)</text>
<text xml:space="preserve" text-anchor="middle" x="769.91" y="-25.94" font-family="Times,serif" font-size="14.00">2020</text>
</a>
</g>
</g>
<!-- RFC8750&#45;&gt;rev_cites -->
<g id="edge8" class="edge">
<title>RFC8750&#45;&gt;rev_cites</title>
<path fill="none" stroke="black" d="M743.6,-127.51C711,-206.21 656.84,-336.99 632.87,-394.84"/>
<polygon fill="black" stroke="black" points="629.67,-393.43 629.08,-404.01 636.14,-396.11 629.67,-393.43"/>
</g>
<!-- RFC9329 -->
<g id="node10" class="node">
<title>RFC9329</title>
<g id="a_node10"><a xlink:href="RFC9329.html" xlink:title="This document describes a method to transport Internet Key Exchange Protocol (IKE) and IPsec packets over a TCP connection for traversing network middleboxes that may block IKE negotiation over UDP. This method, referred to as TCP encapsulation, involves sending both IKE packets for Security Association (SA) establishment and Encapsulating Security Payload (ESP) packets over a TCP connection. This method is intended to be used as a fallback option when IKE cannot be negotiated over UDP. TCP encapsulation for IKE and IPsec was defined in RFC 8229. This document clarifies the specification for TCP encapsulation by including additional clarifications obtained during implementation and deployment of this method. This documents obsoletes RFC 8229." target="_top">
<ellipse fill="none" stroke="black" cx="1191.57" cy="-485.65" rx="148.67" ry="63.99"/>
<text xml:space="preserve" text-anchor="middle" x="1191.57" y="-513.6" font-family="Times,serif" font-size="14.00">RFC9329</text>
<text xml:space="preserve" text-anchor="middle" x="1191.57" y="-497.1" font-family="Times,serif" font-size="14.00">TCP Encapsulation of Internet Key</text>
<text xml:space="preserve" text-anchor="middle" x="1191.57" y="-480.6" font-family="Times,serif" font-size="14.00">Exchange Protocol (IKE) and IPsec</text>
<text xml:space="preserve" text-anchor="middle" x="1191.57" y="-464.1" font-family="Times,serif" font-size="14.00">Packets</text>
<text xml:space="preserve" text-anchor="middle" x="1191.57" y="-447.6" font-family="Times,serif" font-size="14.00">2022</text>
</a>
</g>
</g>
<!-- RFC9329&#45;&gt;rev_cites -->
<g id="edge9" class="edge">
<title>RFC9329&#45;&gt;rev_cites</title>
<path fill="none" stroke="black" d="M1047.18,-470.03C918.08,-456.06 737.57,-436.53 659.42,-428.08"/>
<polygon fill="black" stroke="black" points="660.04,-424.62 649.72,-427.03 659.29,-431.58 660.04,-424.62"/>
</g>
</g>
</svg>
